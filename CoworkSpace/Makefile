# Makefile pour CoworkSpace

.PHONY: help dev prod stop clean logs db test

# Afficher l'aide
help:
	@echo "CoworkSpace - Commandes Docker disponibles:"
	@echo ""
	@echo "  make dev     - DÃ©marrer en mode dÃ©veloppement"
	@echo "  make prod    - DÃ©marrer en mode production"
	@echo "  make stop    - ArrÃªter tous les conteneurs"
	@echo "  make clean   - Nettoyer conteneurs et volumes"
	@echo "  make logs    - Afficher les logs"
	@echo "  make db      - Se connecter Ã  la base de donnÃ©es"
	@echo "  make test    - Lancer les tests"

# Mode dÃ©veloppement
dev:
	@echo "ğŸš€ DÃ©marrage en mode dÃ©veloppement..."
	docker-compose -f docker-compose.dev.yml up --build

# Mode production
prod:
	@echo "ğŸš€ DÃ©marrage en mode production..."
	docker-compose up --build -d
	@echo "âœ… Application dÃ©marrÃ©e !"
	@echo "ğŸŒ Frontend: http://localhost:3001"
	@echo "ğŸ”Œ API: http://localhost:3000/api"

# ArrÃªter les conteneurs
stop:
	@echo "â¹ï¸ ArrÃªt des conteneurs..."
	docker-compose down
	docker-compose -f docker-compose.dev.yml down

# Nettoyer
clean:
	@echo "ğŸ§¹ Nettoyage des conteneurs et volumes..."
	docker-compose down -v --rmi all
	docker-compose -f docker-compose.dev.yml down -v --rmi all
	docker system prune -f

# Logs
logs:
	docker-compose logs -f

# Base de donnÃ©es
db:
	docker exec -it coworkspace-db-dev mongosh -u admin -p password

# Tests
test:
	docker-compose exec backend npm run test